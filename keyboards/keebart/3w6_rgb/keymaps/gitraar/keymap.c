#include QMK_KEYBOARD_H
#include "features/achordion.h"

bool process_record_user(uint16_t keycode, keyrecord_t* record) {
  if (!process_achordion(keycode, record)) { return false; }
  // Your macros ...

  return true;
}

void matrix_scan_user(void) {
  achordion_task();
}

bool achordion_eager_mod(uint8_t mod) {
  switch (mod) {
    case MOD_LSFT:
    case MOD_RSFT:
    case MOD_LCTL:
    case MOD_RCTL:
      return true;  // Eagerly apply Shift and Ctrl mods.

    default:
      return false;
  }
}

// Tap Dance declarations
enum {
    TD_CW_CAPS,
    TD_COMMA,
};

// Tap Dance definitions
tap_dance_action_t tap_dance_actions[] = {
    // Tap once for Caps Word, twice for Caps Lock
    [TD_CW_CAPS] = ACTION_TAP_DANCE_DOUBLE(CW_TOGG, KC_CAPS),
    [TD_COMMA] = ACTION_TAP_DANCE_DOUBLE(KC_COMM, KC_MINS)
};

#define MACPRT G(S(KC_4))
#define CLIP_HIST G(A(KC_BSLS))

#define _BASE 0
#define _NAV 1
#define _MOUSE 2
#define _MEDIA 3
#define _NUM 4
#define _SYM 5
#define _FUN 6

enum custom_keycodes {
    BASE = SAFE_RANGE,
    NAV,
    MOUSE,
    MEDIA,
    NUM,
    SYM,
    FUN,
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

/* Base
 * ,----------------------------------.    ,----------------------------------.
 * |   Q  |   W  |   F  |   P  |   B  |    |   J  |   L  |   U  |   Y  |   '  |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |   A  |   R  |   S  |   T  |   G  |    |   M  |   N  |   E  |   I  |   O  |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |   Z  |   X  |   C  |   D  |   V  |    |   K  |   H  |   ,  |   .  |   /  |
 * `------+------+------+------+------|    |------+------+------+------+------'
 *               |  Esc |  Spc |  Tab |    |  Ent | Bspc |  Del |
 *               `--------------------'    `--------------------'
 */

[_BASE] = LAYOUT_split_3x5_3(
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_Q,          KC_W,          KC_F,          KC_P,          KC_B,                 KC_J,          KC_L,          KC_U,          KC_Y,          KC_QUOT,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      LGUI_T(KC_A),  LALT_T(KC_R),  LCTL_T(KC_S),  LSFT_T(KC_T),  KC_G,                 KC_M,          RSFT_T(KC_N),  RCTL_T(KC_E),  LALT_T(KC_I),  RGUI_T(KC_O),
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_Z,          RALT_T(KC_X),  KC_C,          KC_D,          KC_V,                 KC_K,          KC_H,          TD(TD_COMMA),  RALT_T(KC_DOT),KC_SLSH,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
                                    LT(3,KC_ESC),  LT(1,KC_SPC),  LT(2,KC_TAB),         LT(5,KC_ENT),  LT(4,KC_BSPC), LT(6,KC_DEL)
   //|                             |——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|
),

/* Navigation
 * ,----------------------------------.    ,----------------------------------.
 * |      |      |      |      |      |    | Undo |  Cut | Copy | Paste| PstHi|
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |  GUI |  Alt | Ctrl | Shift|      |    | Caps | Left | Down |  Up  | Right|
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |      |      | Ralt |      |      |    |  Ins | Home | PgDo | PgUp |  End |
 * `------+------+------+------+------|    |------+------+------+------+------'
 *               |      |      |      |    |  Ent | Bspc |  Del |
 *               `--------------------'    `--------------------'
 */

[_NAV] = LAYOUT_split_3x5_3(
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_NO,         KC_NO,         KC_NO,         KC_NO,         KC_NO,                KC_UNDO,       KC_CUT,        KC_COPY,       KC_PSTE,       CLIP_HIST,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_LGUI,       KC_LALT,       KC_LCTL,       KC_LSFT,       KC_NO,                TD(TD_CW_CAPS),KC_LEFT,       KC_DOWN,       KC_UP,         KC_RGHT,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_NO,         KC_RALT,       KC_NO,         KC_NO,         KC_NO,                KC_INS,        KC_HOME,       KC_PGDN,       KC_PGUP,       KC_END,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
                                    KC_NO,         KC_NO,         KC_NO,                KC_ENT,        KC_BSPC,       KC_DEL
   //|                             |——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|
),

/* Mouse
 * ,----------------------------------.    ,----------------------------------.
 * |      |      |      |      |      |    |      |      |      |      |      |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |  GUI |  Alt | Ctrl | Shift|      |    |      |  ML  |  MD  |  MU  |  MR  |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |      |      | Ralt |      |      |    |      |  MWL |  MWD |  MWU |  MWR |
 * `------+------+------+------+------|    |------+------+------+------+------'
 *               |      |      |      |    |  MB2 |  MB1 |  MB3 |
 *               `--------------------'    `--------------------'
 */

[_MOUSE] = LAYOUT_split_3x5_3(
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_NO,         KC_NO,         KC_NO,         KC_NO,         KC_NO,                KC_NO,         KC_NO,         KC_NO,         KC_NO,         KC_NO,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_LGUI,       KC_LALT,       KC_LCTL,       KC_LSFT,       KC_NO,                KC_NO,         KC_MS_L,       KC_MS_D,       KC_MS_U,       KC_MS_R,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_NO,         KC_RALT,       KC_NO,         KC_NO,         KC_NO,                KC_NO,         KC_WH_L,       KC_WH_D,       KC_WH_U,       KC_WH_R,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
                                    KC_NO,         KC_NO,         KC_NO,                KC_BTN2,       KC_BTN1,       KC_BTN3
   //|                             |——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|
),

/* Media
 * ,----------------------------------.    ,----------------------------------.
 * |      |      |      |      |      |    | RGBT | RGBM | RGBH | RGBS | RGBV |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |  GUI |  Alt | Ctrl | Shift|      |    | Sleep| Prev | VolU | VolD | Next |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |      |      | Ralt |      |      |    |      |      |      |      |      |
 * `------+------+------+------+------|    |------+------+------+------+------'
 *               |      |      |      |    | Stop | Play | Mute |
 *               `--------------------'    `--------------------'
 */

[_MEDIA] = LAYOUT_split_3x5_3(
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_NO,         KC_NO,         KC_NO,         KC_NO,         KC_NO,                RGB_TOG,       RGB_MOD,       RGB_HUI,       RGB_SAI,       RGB_VAI,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_LGUI,       KC_LALT,       KC_LCTL,       KC_LSFT,       KC_NO,                KC_SLEP,       KC_MPRV,       KC_VOLD,       KC_VOLU,       KC_MNXT,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_NO,         KC_RALT,       KC_NO,         KC_NO,         KC_NO,                KC_NO,         KC_NO,         KC_NO,         KC_NO,         KC_NO,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
                                    KC_NO,         KC_NO,         KC_NO,                KC_MSTP,       KC_MPLY,       KC_MUTE
   //|                             |——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|
),

/* Numbers
 * ,----------------------------------.    ,----------------------------------.
 * |   [  |   7  |   8  |   9  |   ]  |    |      |      |      |      |      |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |   ;  |   4  |   5  |   6  |   =  |    |      | Shift| Ctrl |  Alt |  GUI |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |   `  |   1  |   2  |   3  |   \  |    |      |      |      | Ralt |      |
 * `------+------+------+------+------|    |------+------+------+------+------'
 *               |   .  |   0  |   -  |    |      |      |      |
 *               `--------------------'    `--------------------'
 */

[_NUM] = LAYOUT_split_3x5_3(
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_LBRC,       KC_7,          KC_8,          KC_9,          KC_RBRC,              KC_NO,         KC_NO,         KC_NO,         KC_NO,         KC_NO,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_SCLN,       KC_4,          KC_5,          KC_6,          KC_EQL,               KC_NO,         KC_RSFT,       KC_RCTL,       KC_LALT,       KC_RGUI,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_GRV,        KC_1,          KC_2,          KC_3,          KC_BSLS,              KC_NO,         KC_NO,         KC_NO,         KC_RALT,       KC_NO,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
                                    KC_DOT,        KC_0,          KC_MINS,              KC_NO,         KC_NO,         KC_NO
   //|                             |——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|
),

/* Symbols
 * ,----------------------------------.    ,----------------------------------.
 * |   {  |   &  |   *  |   (  |   }  |    |      |      |      |      |      |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |   :  |   $  |   %  |   ^  |   +  |    |      | Shift| Ctrl |  Alt |  GUI |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |   ~  |   !  |   @  |   #  |   |  |    |      |      |      | Ralt |      |
 * `------+------+------+------+------|    |------+------+------+------+------'
 *               |   (  |   )  |   _  |    |      |      |      |
 *               `--------------------'    `--------------------'
 */

[_SYM] = LAYOUT_split_3x5_3(
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_LCBR,       KC_AMPR,       KC_ASTR,       KC_LPRN,       KC_RCBR,              KC_NO,         KC_NO,         KC_NO,         KC_NO,         KC_NO,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_COLN,       KC_DLR,        KC_PERC,       KC_CIRC,       KC_PLUS,              KC_NO,         KC_RSFT,       KC_RCTL,       KC_LALT,       KC_RGUI,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_TILD,       KC_EXLM,       KC_AT,         KC_HASH,       KC_PIPE,              KC_NO,         KC_NO,         KC_NO,         KC_RALT,       KC_NO,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
                                    KC_LPRN,       KC_RPRN,       KC_UNDS,              KC_NO,         KC_NO,         KC_NO
   //|                             |——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|
),

/* Function
 * ,----------------------------------.    ,----------------------------------.
 * |  F12 |  F7  |  F8  |  F9  | PrSc |    |      |      |      |      |      |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |  F11 |  F4  |  F5  |  F6  |      |    |      | Shift| Ctrl |  Alt |  GUI |
 * |------+------+------+------+------|    |------+------+------+------+------|
 * |  F10 |  F1  |  F2  |  F3  |      |    |      |      |      | Ralt |      |
 * `------+------+------+------+------|    |------+------+------+------+------'
 *               |  App |  Spc |  Tab |    |      |      |      |
 *               `--------------------'    `--------------------'
 */

[_FUN] = LAYOUT_split_3x5_3(
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_F12,        KC_F7,         KC_F8,         KC_F9,         MACPRT,               KC_NO,         KC_NO,         KC_NO,         KC_NO,         KC_NO,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_F11,        KC_F4,         KC_F5,         KC_F6,         KC_NO,                KC_NO,         KC_RSFT,       KC_RCTL,       KC_LALT,       KC_RGUI,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
      KC_F10,        KC_F1,         KC_F2,         KC_F3,         KC_NO,                KC_NO,         KC_NO,         KC_NO,         KC_RALT,       KC_NO,
   //|——————————————|——————————————|——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|——————————————|——————————————|
                                    KC_APP,        KC_SPC,        KC_TAB,               KC_NO,         KC_NO,         KC_NO
   //|                             |——————————————|——————————————|——————————————|      |——————————————|——————————————|——————————————|
   )
};
